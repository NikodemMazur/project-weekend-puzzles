"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[120],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),c=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=c(e.components);return i.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),u=c(n),m=a,g=u["".concat(s,".").concat(m)]||u[m]||p[m]||r;return n?i.createElement(g,l(l({ref:t},d),{},{components:n})):i.createElement(g,l({ref:t},d))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,l=new Array(r);l[0]=u;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var c=2;c<r;c++)l[c]=n[c];return i.createElement.apply(null,l)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},6958:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return o},metadata:function(){return s},toc:function(){return c},default:function(){return p}});var i=n(7462),a=n(3366),r=(n(7294),n(3905)),l=["components"],o={sidebar_position:3},s={unversionedId:"getting-started/creating-module",id:"getting-started/creating-module",isDocsHomePage:!1,title:"Creating module",description:"To easier understand what it is necessary for a piece of code to be a ProjectWeekendPuzzles' module, the first part of the guide shows the minimum steps needed to plug a non-reactive view into the application shell. The result is a blank view injected into the main-content-region region. The view, however, cannot yet be controlled through IPC; the API implementation is shown in a further part of the guide. In the other part, a user is guided to provide a reactive content that can be controlled through gRPC API. Upon completing the guide, a user has enough knowledge to create a module that can do anything a normal WPF user control can, even though it is controlled externally",source:"@site/docs/getting-started/creating-module.md",sourceDirName:"getting-started",slug:"/getting-started/creating-module",permalink:"/project-weekend-puzzles/docs/getting-started/creating-module",editUrl:"https://github.com/NikodemMazur/project-weekend-puzzles/edit/master/website/docs/getting-started/creating-module.md",version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Building",permalink:"/project-weekend-puzzles/docs/getting-started/building"},next:{title:"To do list",permalink:"/project-weekend-puzzles/docs/to-do-list"}},c=[{value:"Creating a blank module",id:"creating-a-blank-module",children:[{value:"Create a main project",id:"create-a-main-project",children:[]},{value:"Create a simple view",id:"create-a-simple-view",children:[]},{value:"Create a module class",id:"create-a-module-class",children:[]},{value:"Implement <code>IHeadered</code>",id:"implement-iheadered",children:[]},{value:"Set up the deploy",id:"set-up-the-deploy",children:[]},{value:"Add the module to the application",id:"add-the-module-to-the-application",children:[]},{value:"Run the project",id:"run-the-project",children:[]}]},{value:"Providing reactive content",id:"providing-reactive-content",children:[{value:"Create a model",id:"create-a-model",children:[]},{value:"Create a view model",id:"create-a-view-model",children:[]},{value:"Reimplement the view",id:"reimplement-the-view",children:[]},{value:"Create an API service",id:"create-an-api-service",children:[]},{value:"Create an API client",id:"create-an-api-client",children:[]},{value:"Run the project",id:"run-the-project-1",children:[]}]}],d={toc:c};function p(e){var t=e.components,o=(0,a.Z)(e,l);return(0,r.kt)("wrapper",(0,i.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"To easier understand what it is necessary for a piece of code to be a ProjectWeekendPuzzles' module, the first part of the guide shows the minimum steps needed to plug a non-reactive view into the application shell. The result is a blank view injected into the ",(0,r.kt)("inlineCode",{parentName:"p"},"main-content-region")," region. The view, however, cannot yet be controlled through IPC; the API implementation is shown in a further part of the guide. In the other part, a user is guided to provide a reactive content that can be controlled through gRPC API. Upon completing the guide, a user has enough knowledge to create a module that can do anything a normal WPF user control can, even though it is controlled externally"),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"How to follow this guide")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Do not skip any steps. A text instruction is followed (or not) by a related graphic; never the other way round"))),(0,r.kt)("h2",{id:"creating-a-blank-module"},"Creating a blank module"),(0,r.kt)("p",null,"This part shows how to inject a blank view into the application using ",(0,r.kt)("em",{parentName:"p"},"WPF"),", ",(0,r.kt)("em",{parentName:"p"},"Prism"),", ",(0,r.kt)("em",{parentName:"p"},"Material Design"),", and ",(0,r.kt)("em",{parentName:"p"},"ProjectWeekendPuzzles.Core.dll")),(0,r.kt)("h3",{id:"create-a-main-project"},"Create a main project"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Open Visual Studio and create a new ",(0,r.kt)("em",{parentName:"li"},"WPF User Control Library")," project")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Project type",src:n(9487).Z})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Set the project name to ",(0,r.kt)("inlineCode",{parentName:"li"},"ProjectWeekendPuzzles.<YourModule>")),(0,r.kt)("li",{parentName:"ul"},"Set the project location to: ",(0,r.kt)("inlineCode",{parentName:"li"},"<your-repo-folder>\\project-weekend-puzzles\\src\\modules")),(0,r.kt)("li",{parentName:"ul"},"Set the solution name to ",(0,r.kt)("inlineCode",{parentName:"li"},"<your-module>")," (Note the different naming conventions, ",(0,r.kt)("inlineCode",{parentName:"li"},"<YourModule>"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"<your-module>"),")")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Project configuration",src:n(3312).Z})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Choose .NET 5 for Windows")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Project target",src:n(7376).Z})),(0,r.kt)("p",null,"For the purpose of this guide, we are going to create everything from scratch."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Remove the user control the project scaffolding has created. Next, create ",(0,r.kt)("inlineCode",{parentName:"li"},"Views")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"ViewModels")," folders")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"View and ViewModels folders",src:n(1909).Z})),(0,r.kt)("h3",{id:"create-a-simple-view"},"Create a simple view"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"To ",(0,r.kt)("inlineCode",{parentName:"li"},"Views")," folder, add a new User Control (WPF) and name it ",(0,r.kt)("inlineCode",{parentName:"li"},"<YourModule>View"))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"User Control (WPF)",src:n(2039).Z})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add ",(0,r.kt)("inlineCode",{parentName:"li"},"MaterialDesign")," package references")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Material Design package references",src:n(9131).Z})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add ",(0,r.kt)("inlineCode",{parentName:"li"},"materialDesign")," namespace"),(0,r.kt)("li",{parentName:"ul"},"Add following resource dictionaries (to use ",(0,r.kt)("inlineCode",{parentName:"li"},"MaterialDesign")," controls and icons)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'{7,11-18,21-24} title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\Views\\StepListView.xaml"',"{7,11-18,21-24}":!0,title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\Views\\StepListView.xaml"'},'<UserControl x:Class="ProjectWeekendPuzzles.StepList.Views.StepListView"\n             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"\n             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"\n             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" \n             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" \n             xmlns:local="clr-namespace:ProjectWeekendPuzzles.StepList"\n             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"\n             mc:Ignorable="d" \n             d:DesignHeight="450" d:DesignWidth="800">\n    \n    <UserControl.Resources>\n        <ResourceDictionary>\n            <ResourceDictionary.MergedDictionaries>\n                <materialDesign:BundledTheme BaseTheme="{x:Null}" PrimaryColor="DeepPurple" SecondaryColor="Yellow"  />\n                <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Defaults.xaml" />\n            </ResourceDictionary.MergedDictionaries>\n        </ResourceDictionary>\n    </UserControl.Resources>\n    \n    <Grid>\n        <TextBlock Text="Hello from my new module!"\n                   Style="{DynamicResource MaterialDesignHeadline3TextBlock}"\n                   VerticalAlignment="Center"\n                   TextAlignment="Center" />\n    </Grid>\n    \n</UserControl>\n')),(0,r.kt)("p",null,"Optionally, build the project to verify that everything is fine so far"),(0,r.kt)("h3",{id:"create-a-module-class"},"Create a module class"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add a new class named ",(0,r.kt)("inlineCode",{parentName:"li"},"<YourModule>Module"))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"New class",src:n(1827).Z})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add ",(0,r.kt)("inlineCode",{parentName:"li"},"Prism.Wpf")," package reference")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Prism.Wpf package reference",src:n(6182).Z})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Make the class ",(0,r.kt)("inlineCode",{parentName:"li"},"public")),(0,r.kt)("li",{parentName:"ul"},"Implement ",(0,r.kt)("inlineCode",{parentName:"li"},"IModule")),(0,r.kt)("li",{parentName:"ul"},"Remove ",(0,r.kt)("inlineCode",{parentName:"li"},"throw"),"s"),(0,r.kt)("li",{parentName:"ul"},"Create ctor and ask for ",(0,r.kt)("inlineCode",{parentName:"li"},"IRegionManager")," service"),(0,r.kt)("li",{parentName:"ul"},"In the ",(0,r.kt)("inlineCode",{parentName:"li"},"OnInitialized")," method register ",(0,r.kt)("inlineCode",{parentName:"li"},"<YourModule>View")," in the ",(0,r.kt)("inlineCode",{parentName:"li"},"main-content-region")," region")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\StepListModule.cs"',title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\StepListModule.cs"'},'using Prism.Ioc;\nusing Prism.Modularity;\nusing Prism.Regions;\nusing ProjectWeekendPuzzles.StepList.Views;\n\nnamespace ProjectWeekendPuzzles.StepList\n{\n    public class StepListModule : IModule\n    {\n        private readonly IRegionManager _regionManager;\n\n        public StepListModule(IRegionManager regionManager)\n        {\n            _regionManager = regionManager;\n        }\n\n        public void OnInitialized(IContainerProvider containerProvider)\n        {\n            _regionManager.RegisterViewWithRegion<StepListView>("main-content-region");\n        }\n\n        public void RegisterTypes(IContainerRegistry containerRegistry)\n        {\n            \n        }\n    }\n}\n\n')),(0,r.kt)("h3",{id:"implement-iheadered"},"Implement ",(0,r.kt)("inlineCode",{parentName:"h3"},"IHeadered")),(0,r.kt)("p",null,"A view that is registered in the ",(0,r.kt)("inlineCode",{parentName:"p"},"main-content-region")," region must meet a contract defined by ",(0,r.kt)("inlineCode",{parentName:"p"},"IHeadered")," interface which, as its name suggests, forces an implementation to provide an object that will represent a tab header."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add the project reference to ProjectWeekendPuzzles.dll; it can be found here:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"..\\..\\..\\..\\src\\app\\ProjectWeekendPuzzles\\bin\\Debug\\net5.0-windows\\ProjectWeekendPuzzles.Core.dll\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Project reference",src:n(6348).Z})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Upon successful addition, the project dependencies should look like this")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Project reference added",src:n(5561).Z})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Merge the following resource dictionary that contains predefined icon sizes used throughout the application")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'{16} title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\Views\\StepListView.xaml"',"{16}":!0,title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\Views\\StepListView.xaml"'},'<UserControl x:Class="ProjectWeekendPuzzles.StepList.Views.StepListView"\n             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"\n             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"\n             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" \n             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" \n             xmlns:local="clr-namespace:ProjectWeekendPuzzles.StepList"\n             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"\n             mc:Ignorable="d" \n             d:DesignHeight="450" d:DesignWidth="800">\n    \n    <UserControl.Resources>\n        <ResourceDictionary>\n            <ResourceDictionary.MergedDictionaries>\n                <materialDesign:BundledTheme BaseTheme="{x:Null}" PrimaryColor="DeepPurple" SecondaryColor="Yellow"  />\n                <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Defaults.xaml" />\n                <ResourceDictionary Source="pack://application:,,,/ProjectWeekendPuzzles.Core;component/ResourceDictionaries/Dimensions.xaml" />\n            </ResourceDictionary.MergedDictionaries>\n        </ResourceDictionary>\n    </UserControl.Resources>\n    \n    <Grid>\n        <TextBlock Text="Hello from my new module!"\n                   Style="{DynamicResource MaterialDesignHeadline3TextBlock}"\n                   VerticalAlignment="Center"\n                   TextAlignment="Center" />\n    </Grid>\n    \n</UserControl>\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Go to the view's code-behind and implement the ",(0,r.kt)("inlineCode",{parentName:"li"},"IHeadered")," interface")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'{1-2,11,13,19-22,25} title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\Views\\StepListView.xaml.cs"',"{1-2,11,13,19-22,25}":!0,title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\Views\\StepListView.xaml.cs"'},'using MaterialDesignThemes.Wpf;\nusing ProjectWeekendPuzzles.Core.ViewContract;\nusing System;\nusing System.Windows.Controls;\n\nnamespace ProjectWeekendPuzzles.StepList.Views\n{\n    /// <summary>\n    /// Interaction logic for StepListView.xaml\n    /// </summary>\n    public partial class StepListView : UserControl, IHeadered\n    {\n        private readonly PackIcon _navigationIcon;\n\n        public StepListView()\n        {\n            InitializeComponent();\n\n            var iconSize = (double)FindResource("IconSize"); // Works only if ResourceDictionary component has been initialized before\n                                                             // (has been referenced in xaml and FindResource method has been called after InitializeComponent)\n                                                             // Another interesting approach of referencing resource in code-behind: https://stackoverflow.com/a/24286059\n            _navigationIcon = new PackIcon { Kind = Enum.Parse<PackIconKind>("ListStatus"), Width = iconSize, Height = iconSize };\n        }\n\n        public object TabHeader => _navigationIcon;\n    }\n}\n')),(0,r.kt)("h3",{id:"set-up-the-deploy"},"Set up the deploy"),(0,r.kt)("p",null,"Upon a successful build, our assemblies should be moved to the place where the ",(0,r.kt)("em",{parentName:"p"},"ProjectWeekendPuzzles.exe")," executable is located"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add the ",(0,r.kt)("inlineCode",{parentName:"li"},"xcopy")," post-build action to put your module dlls in the folder which the main application lives in")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Project properties",src:n(3151).Z})),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Post-build event command",src:n(2279).Z})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell",metastring:'title="Post-build event command of ProjectWeekendPuzzles.StepList.csproj"',title:'"Post-build',event:!0,command:!0,of:!0,'ProjectWeekendPuzzles.StepList.csproj"':!0},'xcopy "$(TargetDir)*.*" "$(SolutionDir)..\\..\\..\\src\\app\\ProjectWeekendPuzzles\\$(OutDir)" /Y /I\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Force copying dependent dlls to the main application folder")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'{6} title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\ProjectWeekendPuzzles.StepList.csproj"',"{6}":!0,title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\ProjectWeekendPuzzles.StepList.csproj"'},"...\n\n  <PropertyGroup>\n    <TargetFramework>net5.0-windows</TargetFramework>\n    <UseWPF>true</UseWPF>\n    <CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>\n  </PropertyGroup>\n\n...\n")),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Yeah, you are right, that is not an elegant way of delivering modules. In the target application one should consider extending the Prism's module loading mechanism with something like ",(0,r.kt)("inlineCode",{parentName:"p"},"NugetModuleCatalog")))),(0,r.kt)("h3",{id:"add-the-module-to-the-application"},"Add the module to the application"),(0,r.kt)("p",null,"The application does not have any discovery mechanisms. You have to tell it what modules it should load"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'{12-13} title="\\src\\app\\ProjectWeekendPuzzles\\bin\\Debug\\net5.0-windows\\ProjectWeekendPuzzles.dll.config"',"{12-13}":!0,title:'"\\src\\app\\ProjectWeekendPuzzles\\bin\\Debug\\net5.0-windows\\ProjectWeekendPuzzles.dll.config"'},'<?xml version="1.0" encoding="utf-8" ?>\n<configuration>\n  <configSections>\n    <section name="modules" type="Prism.Modularity.ModulesConfigurationSection, Prism.Wpf" />\n  </configSections>\n  \n  <appSettings>\n    <add key="port" value="55331" />\n  </appSettings>\n\n  <modules>\n    <module assemblyFile="ProjectWeekendPuzzles.StepList.dll" moduleType="ProjectWeekendPuzzles.StepList.StepListModule, ProjectWeekendPuzzles.StepList, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"\n            moduleName="StepListModule" startupLoaded="True" />\n    <module assemblyFile="ProjectWeekendPuzzles.ModuleInfo.dll" moduleType="ProjectWeekendPuzzles.ModuleInfo.ModuleInfoModule, ProjectWeekendPuzzles.ModuleInfo, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"\n            moduleName="ModuleInfoModule" startupLoaded="True" />\n    <module assemblyFile="ProjectWeekendPuzzles.Dashboard.dll" moduleType="ProjectWeekendPuzzles.Dashboard.DashboardModule, ProjectWeekendPuzzles.Dashboard, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"\n            moduleName="DashboardModule" startupLoaded="True" />\n  </modules>\n  \n</configuration>\n')),(0,r.kt)("h3",{id:"run-the-project"},"Run the project"),(0,r.kt)("p",null,"Visual Studio allows for debugging a project through another executable. The project weekend puzzles' development style highly benefits from this feature as a single module cannot be run on its own"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Set the project debug properties as in the picture below")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Project debug properties",src:n(2632).Z})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none",metastring:'title="Executable path in ProjectWeekendPuzzles.StepList.csproj Debug properties"',title:'"Executable',path:!0,in:!0,"ProjectWeekendPuzzles.StepList.csproj":!0,Debug:!0,'properties"':!0},"<your-repo-folder>\\project-weekend-puzzles\\src\\app\\ProjectWeekendPuzzles\\bin\\Debug\\net5.0-windows\\ProjectWeekendPuzzles.exe\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none",metastring:'title="Working directory in ProjectWeekendPuzzles.StepList.csproj Debug properties"',title:'"Working',directory:!0,in:!0,"ProjectWeekendPuzzles.StepList.csproj":!0,Debug:!0,'properties"':!0},"<your-repo-folder>\\project-weekend-puzzles\\src\\app\\ProjectWeekendPuzzles\\bin\\Debug\\net5.0-windows\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Run your project and see the application with your module loaded")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Module loaded",src:n(8783).Z})),(0,r.kt)("h2",{id:"providing-reactive-content"},"Providing reactive content"),(0,r.kt)("p",null,"This part will guide you through providing a reactive content. The interactions between ",(0,r.kt)("strong",{parentName:"p"},"M"),", ",(0,r.kt)("strong",{parentName:"p"},"V"),", and ",(0,r.kt)("strong",{parentName:"p"},"VM")," will be implemented thoroughly with the Observer Pattern. Once the model along with UI is ready, a connection with the outside world will be established with a use of gRPC."),(0,r.kt)("h3",{id:"create-a-model"},"Create a model"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Create a new .NET Core class library project and name it ",(0,r.kt)("inlineCode",{parentName:"li"},"ProjectWeekendPuzzles.<YourModule>.Model"),". Modify the ",(0,r.kt)("inlineCode",{parentName:"li"},"<TargetFramework>")," element so that the project targets Windows.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'{4} title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Model\\ProjectWeekendPuzzles.StepList.Model.csproj"',"{4}":!0,title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Model\\ProjectWeekendPuzzles.StepList.Model.csproj"'},'<Project Sdk="Microsoft.NET.Sdk">\n\n  <PropertyGroup>\n    <TargetFramework>net5.0-windows</TargetFramework>\n  </PropertyGroup>\n\n</Project>\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add a class that will carry information about a single step. Use C# 9.0 ",(0,r.kt)("inlineCode",{parentName:"li"},"record"),"s for the auto-overriden equality semantics that will be useful when making an ",(0,r.kt)("inlineCode",{parentName:"li"},"ObservableCollection<T>")," from ",(0,r.kt)("inlineCode",{parentName:"li"},"IObservable<T>"),". The property ",(0,r.kt)("inlineCode",{parentName:"li"},"Id")," of type ",(0,r.kt)("inlineCode",{parentName:"li"},"Guid")," is introduced to let for duplicates in an ",(0,r.kt)("inlineCode",{parentName:"li"},"ObservableCollection<T>"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Model\\Step.cs"',title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Model\\Step.cs"'},"using System;\n\nnamespace ProjectWeekendPuzzles.StepList.Model\n{\n    public record Step\n    {\n        public Step(string name, string result, StepStatus status)\n        {\n            Name = name ?? throw new ArgumentNullException(nameof(name));\n            Result = result ?? throw new ArgumentNullException(nameof(result));\n            Status = status;\n            Id = Guid.NewGuid();\n        }\n\n        public Guid Id { get; }\n        public string Name { get; }\n        public string Result { get; }\n        public StepStatus Status { get; }\n\n        public enum StepStatus\n        {\n            Pass,\n            Fail,\n            Error\n        };\n    }\n}\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Create an entity that will be shared (as a singleton instance) between the API service and the view model. Let it be mutable to limit the IPC traffic. Add two essential methods that allow for populating and clearing a viewed list.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Model\\StepListModel.cs"',title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Model\\StepListModel.cs"'},"using System;\nusing System.Collections.Concurrent;\nusing System.Collections.Generic;\nusing System.Linq;\n\nnamespace ProjectWeekendPuzzles.StepList.Model\n{\n    public class StepListModel\n    {\n        private readonly ConcurrentQueue<Step> _steps = new();\n\n        public void AddSteps(IEnumerable<Step> steps)\n        {\n            steps\n                .ToList()\n                .ForEach(x => _steps.Enqueue(x));\n        }\n\n        public void Clear()\n        {\n            _steps.Clear();\n        }\n    }\n}\n")),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"You may wonder why the heck do you need a separate project for a couple of classes? Well, theoretically you do not. However, things get complicated when gRPC tools are used along with the WPF project. You will learn the motivation for this approach when creating the API project later"))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Let's use the ",(0,r.kt)("inlineCode",{parentName:"li"},"IObservable<T>")," interface to let the model notify listeners about its state changes. As implementing ",(0,r.kt)("inlineCode",{parentName:"li"},"IObservable<T>")," is rather cumbersome, a more convenient approach is to use the reactive extensions to do that. Add a package reference to ",(0,r.kt)("inlineCode",{parentName:"li"},"System.Reactive")," and use the ",(0,r.kt)("inlineCode",{parentName:"li"},"Observable.FromEvent<T>")," method to create an ",(0,r.kt)("inlineCode",{parentName:"li"},"IObservable<T>")," that is controlled through .NET ",(0,r.kt)("inlineCode",{parentName:"li"},"event"),"s. This method converts Action-based ",(0,r.kt)("inlineCode",{parentName:"li"},"event")," to an observable sequence and is the fastest way to implement the Observer Pattern in our case.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'{5,9,11-12,15-19,27,34,37} title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Model\\StepListModel.cs"',"{5,9,11-12,15-19,27,34,37}":!0,title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Model\\StepListModel.cs"'},"using System;\nusing System.Collections.Concurrent;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Reactive.Linq;\n\nnamespace ProjectWeekendPuzzles.StepList.Model\n{\n    public class StepListModel : IObservable<IEnumerable<Step>>\n    {\n        private readonly IObservable<IEnumerable<Step>> _observable;\n        private event Action<IEnumerable<Step>> ListChanged;\n        private readonly ConcurrentQueue<Step> _steps = new();\n\n        public StepListModel()\n        {\n            ListChanged += _ => { };\n            _observable = Observable.FromEvent<IEnumerable<Step>>(a => ListChanged += a, a => ListChanged -= a);\n        }\n\n        public void AddSteps(IEnumerable<Step> steps)\n        {\n            steps\n                .ToList()\n                .ForEach(x => _steps.Enqueue(x));\n\n            ListChanged.Invoke(_steps);\n        }\n\n        public void Clear()\n        {\n            _steps.Clear();\n\n            ListChanged.Invoke(_steps);\n        }\n\n        public IDisposable Subscribe(IObserver<IEnumerable<Step>> observer) => _observable.Subscribe(observer);\n    }\n}\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Once you finish the model, register it as a singleton in the IoC. Do not forget about referencing the model project to make its namespace accessible in the ",(0,r.kt)("inlineCode",{parentName:"li"},"<YourModule>Module")," class.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'{4,25} title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\StepListModule.cs"',"{4,25}":!0,title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\StepListModule.cs"'},'using Prism.Ioc;\nusing Prism.Modularity;\nusing Prism.Regions;\nusing ProjectWeekendPuzzles.StepList.Model;\nusing ProjectWeekendPuzzles.StepList.Views;\n\nnamespace ProjectWeekendPuzzles.StepList\n{\n    public class StepListModule : IModule\n    {\n        private readonly IRegionManager _regionManager;\n\n        public StepListModule(IRegionManager regionManager)\n        {\n            _regionManager = regionManager;\n        }\n\n        public void OnInitialized(IContainerProvider containerProvider)\n        {\n            _regionManager.RegisterViewWithRegion<StepListView>("main-content-region");\n        }\n\n        public void RegisterTypes(IContainerRegistry containerRegistry)\n        {\n            containerRegistry.RegisterSingleton<StepListModel>();\n        }\n    }\n}\n')),(0,r.kt)("h3",{id:"create-a-view-model"},"Create a view model"),(0,r.kt)("p",null,"Having the model defined and implemented, it is time to subscribe to it. We will use ",(0,r.kt)("inlineCode",{parentName:"p"},"DynamicData")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"ReactiveUI")," packages to easily write a logic that keeps track of changes of the model. This way, both the view model and the view will be updated by observables."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Port ",(0,r.kt)("inlineCode",{parentName:"li"},"IObservable<IEnumerable<T>>")," to ",(0,r.kt)("inlineCode",{parentName:"li"},"ObservableCollection<T>")," with ",(0,r.kt)("inlineCode",{parentName:"li"},"IChangeSet<T>"),". This way, produced ",(0,r.kt)("inlineCode",{parentName:"li"},"ReadOnlyObservableCollection<T>")," will be fully reactive which let a WPF control render only newly added items rather than them all")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\ViewModels\\StepListViewModel.cs"',title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\ViewModels\\StepListViewModel.cs"'},"using DynamicData;\nusing DynamicData.Binding;\nusing ProjectWeekendPuzzles.StepList.Model;\nusing ReactiveUI;\nusing System;\nusing System.Collections.ObjectModel;\nusing System.Reactive.Linq;\n\nnamespace ProjectWeekendPuzzles.StepList.ViewModels\n{\n    public class StepListViewModel : ReactiveObject\n    {\n        private ReadOnlyObservableCollection<Step> _stepList;\n        public ReadOnlyObservableCollection<Step> StepList => _stepList;\n\n        public StepListViewModel(StepListModel stepListModel)\n        {\n            stepListModel\n                .ObserveOn(RxApp.MainThreadScheduler)\n                .ToObservableChangeSet(x => x.Id)\n                .IgnoreUpdateWhen((curr, prev) => curr.Equals(prev)) // The whole IChangeSet is said to be updated every time a new item is added though the old items remained \n                .Bind(out _stepList)                                 // unchanged. To prevent an unnecessary rendering of items one should explicitly discard updates with a simple predicate.\n                .Subscribe();\n        }\n    }\n}\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"To enable the Prism's view model location, go to the .xaml and set ",(0,r.kt)("inlineCode",{parentName:"li"},"AutoWireViewModel")," to ",(0,r.kt)("inlineCode",{parentName:"li"},"True"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'{8-9} title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\Views\\StepListView.xaml"',"{8-9}":!0,title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\Views\\StepListView.xaml"'},'<UserControl x:Class="ProjectWeekendPuzzles.StepList.Views.StepListView"\n             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"\n             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"\n             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" \n             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" \n             xmlns:local="clr-namespace:ProjectWeekendPuzzles.StepList"\n             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"\n             xmlns:prism="http://prismlibrary.com/"\n             prism:ViewModelLocator.AutoWireViewModel="True"\n             mc:Ignorable="d" \n             d:DesignHeight="450" d:DesignWidth="800">\n    \n    <UserControl.Resources>\n        <ResourceDictionary>\n            <ResourceDictionary.MergedDictionaries>\n                <materialDesign:BundledTheme BaseTheme="{x:Null}" PrimaryColor="DeepPurple" SecondaryColor="Yellow"  />\n                <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Defaults.xaml" />\n                <ResourceDictionary Source="pack://application:,,,/ProjectWeekendPuzzles.Core;component/ResourceDictionaries/Dimensions.xaml" />\n            </ResourceDictionary.MergedDictionaries>\n        </ResourceDictionary>\n    </UserControl.Resources>\n    \n    <Grid>\n        <TextBlock Text="Hello from my new module!"\n                   Style="{DynamicResource MaterialDesignHeadline3TextBlock}"\n                   VerticalAlignment="Center"\n                   TextAlignment="Center" />\n    </Grid>\n    \n</UserControl>\n')),(0,r.kt)("h3",{id:"reimplement-the-view"},"Reimplement the view"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add ",(0,r.kt)("inlineCode",{parentName:"li"},"ListBox")," control and equip it with a small set of additional functionalities to improve the UX. Use ",(0,r.kt)("inlineCode",{parentName:"li"},"ReactiveUI"),"'s disposable type-safe bindings")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\Views\\StepListView.xaml"',title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\Views\\StepListView.xaml"'},'<views:StepListViewBase x:Class="ProjectWeekendPuzzles.StepList.Views.StepListView"\n             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"\n             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"\n             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" \n             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" \n             xmlns:local="clr-namespace:ProjectWeekendPuzzles.StepList"\n             xmlns:views="clr-namespace:ProjectWeekendPuzzles.StepList.Views"\n             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"\n             xmlns:prism="http://prismlibrary.com/"\n             xmlns:diag="clr-namespace:System.Diagnostics;assembly=WindowsBase"\n             prism:ViewModelLocator.AutoWireViewModel="True"\n             mc:Ignorable="d" \n             d:DesignHeight="450" d:DesignWidth="800">\n    \n    <UserControl.Resources>\n        <ResourceDictionary>\n            <ResourceDictionary.MergedDictionaries>\n                <materialDesign:BundledTheme BaseTheme="{x:Null}" PrimaryColor="DeepPurple" SecondaryColor="Yellow"  />\n                <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Defaults.xaml" />\n                <ResourceDictionary Source="pack://application:,,,/ProjectWeekendPuzzles.Core;component/ResourceDictionaries/Dimensions.xaml" />\n            </ResourceDictionary.MergedDictionaries>\n            <Style TargetType="materialDesign:ColorZone">\n                <Style.Triggers>\n                    <DataTrigger Binding="{Binding Status}" Value="Pass">\n                        <Setter Property="Background" Value="Green" />\n                    </DataTrigger>\n                    <DataTrigger Binding="{Binding Status}" Value="Fail">\n                        <Setter Property="Background" Value="Crimson" />\n                    </DataTrigger>\n                    <DataTrigger Binding="{Binding Status}" Value="Error">\n                        <Setter Property="Background" Value="BlueViolet" />\n                    </DataTrigger>\n                </Style.Triggers>\n            </Style>\n        </ResourceDictionary>\n        \n    </UserControl.Resources>\n    \n    <Grid>\n        <Grid.RowDefinitions>\n            <RowDefinition Height="Auto" />\n            <RowDefinition Height="*" />\n        </Grid.RowDefinitions>\n\n        <materialDesign:Card Margin="29,13,32,10"\n                             UniformCornerRadius="2">\n\n            <Grid Margin="8,10,33,10">\n                    <Grid.ColumnDefinitions>\n                        <ColumnDefinition Width="1*" />\n                        <ColumnDefinition Width="1*" />\n                        <ColumnDefinition Width="0.15*" />\n                    </Grid.ColumnDefinitions>\n                    \n                    <TextBlock Text="Name"\n                               TextAlignment="Left" />\n\n                    <TextBlock Text="Result"\n                               TextAlignment="Left"\n                               Grid.Column="1" />\n\n                    <TextBlock Text="Status"\n                               TextAlignment="Left"\n                               Grid.Column="2" />\n                </Grid>\n                \n        </materialDesign:Card>\n\n        <ScrollViewer Grid.Row="1"\n                      Margin="24 2 2 2"\n                      materialDesign:ScrollViewerAssist.IgnorePadding="False"\n                      materialDesign:ScrollViewerAssist.IsAutoHideEnabled="True"\n                      Style="{DynamicResource MaterialDesignScrollViewer}"\n                      Name="ScrollViewer"\n                      ScrollChanged="ScrollViewer_ScrollChanged"\n                      PreviewMouseWheel="ScrollViewer_PreviewMouseWheel"\n                      CanContentScroll="True">\n\n            <ListBox x:Name="Steps"\n                     Visibility="Visible"\n                     Style="{DynamicResource MaterialDesignCardsListBox}"\n                     Margin="5">\n                <ItemsControl.ItemTemplate>\n                    <DataTemplate>\n\n                        <Border Padding="8"\n                                    Name="ItemBorder"\n                                    BorderThickness="0 0 0 1"\n                                    BorderBrush="{DynamicResource MaterialDesignDivider}">\n\n                                <Grid x:Name="ItemsControlGrid">\n                                    <Grid.ColumnDefinitions>\n                                        <ColumnDefinition Width="1*" />\n                                        <ColumnDefinition Width="1*" />\n                                        <ColumnDefinition Width="0.2*" />\n                                    </Grid.ColumnDefinitions>\n\n                                    <TextBlock Text="{Binding Name}"\n                                       VerticalAlignment="Center" />\n\n                                    <TextBlock Text="{Binding Result}"\n                                       VerticalAlignment="Center"\n                                       Grid.Column="1" />\n\n                                    <ContentControl HorizontalAlignment="Stretch"\n                                            Grid.Column="2">\n                                        <materialDesign:ColorZone materialDesign:ShadowAssist.ShadowDepth="Depth2"\n                                                          CornerRadius="5"\n                                                          Padding="8">\n                                            <TextBlock Text="{Binding Status}"\n                                               TextAlignment="Center" />\n                                        </materialDesign:ColorZone>\n                                    </ContentControl>\n\n                                </Grid>\n                            \n                            </Border>\n                        \n                    </DataTemplate>\n                </ItemsControl.ItemTemplate>\n            </ListBox>\n            \n        </ScrollViewer>\n        \n    </Grid>\n    \n</views:StepListViewBase>\n')),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"In the .xaml above, two types of bindings have been combined together; the ",(0,r.kt)("inlineCode",{parentName:"p"},"ReactiveUI")," type-safe bindings (through explicitly named control ",(0,r.kt)("inlineCode",{parentName:"p"},"Steps"),") and the traditional XAML markup bindings with ",(0,r.kt)("inlineCode",{parentName:"p"},"{Binding XXX}"),". However, it is a good practice to choose only one approach and stick to it throughout the development"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\Views\\StepListView.xaml.cs"',title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\Views\\StepListView.xaml.cs"'},'using MaterialDesignThemes.Wpf;\nusing Prism.Regions;\nusing ProjectWeekendPuzzles.Core.ViewContract;\nusing ProjectWeekendPuzzles.StepList.ViewModels;\nusing ReactiveUI;\nusing System;\nusing System.Reactive.Disposables;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Media;\nusing System.Windows.Media.Animation;\n\nnamespace ProjectWeekendPuzzles.StepList.Views\n{\n    public class StepListViewBase : ReactiveUserControl<StepListViewModel> { }\n\n    /// <summary>\n    /// Interaction logic for StepListView.xaml\n    /// </summary>\n    [RegionMemberLifetime(KeepAlive = true)]\n    public partial class StepListView : StepListViewBase, IHeadered\n    {\n        private readonly PackIcon _navigationIcon;\n\n        private readonly ColorAnimation _newItemAnimation = new() { To = Colors.Yellow, Duration = new Duration(TimeSpan.FromMilliseconds(300)), AutoReverse = true };\n\n        public StepListView()\n        {\n            InitializeComponent();\n\n            #region ReactiveUI type-safe bindings\n\n            this.WhenActivated(disposableRegistration =>\n            {\n                ViewModel = (StepListViewModel)DataContext;\n\n                this.OneWayBind(ViewModel, vm => vm.StepList, v => v.Steps.ItemsSource)\n                    .DisposeWith(disposableRegistration);\n            });\n\n            #endregion\n\n            var iconSize = (double)FindResource("IconSize"); // Works only if ResourceDictionary component has been initialized before\n                                                             // (has been referenced in xaml and FindResource method has been called after InitializeComponent)\n                                                             // Another interesting approach of referencing resource in code-behind: https://stackoverflow.com/a/24286059\n            _navigationIcon = new PackIcon { Kind = Enum.Parse<PackIconKind>("ListStatus"), Width = iconSize, Height = iconSize };\n\n            Steps.ItemContainerGenerator.StatusChanged += (sender, e) =>\n                Steps.Dispatcher.Invoke(() => ItemContainerGenerator_StatusChanged(sender, e));\n        }\n\n        public object TabHeader => _navigationIcon;\n\n        #region Non-essential\n\n        private int _previouslyHighlightedItemIndex;\n\n        private void ItemContainerGenerator_StatusChanged(object sender, EventArgs e)\n        {\n            var icg = (ItemContainerGenerator)sender;\n\n            var totalCount = icg.Items.Count;\n\n            for (int i = _previouslyHighlightedItemIndex; i < totalCount; i++)\n            {\n                var lbi = icg.ContainerFromIndex(i) as ListBoxItem;\n\n                if (FindChild<Border>(lbi, "ItemBorder") is { } border)\n                {\n                    border.Background = new SolidColorBrush(Colors.Transparent);\n                    border.Background.BeginAnimation(SolidColorBrush.ColorProperty, _newItemAnimation);\n\n                    _previouslyHighlightedItemIndex++;\n                }\n            }\n\n            _previouslyHighlightedItemIndex = Math.Min(totalCount, _previouslyHighlightedItemIndex);\n        }\n\n        private bool _autoscroll = true;\n\n        private void ScrollViewer_ScrollChanged(object sender, ScrollChangedEventArgs e)\n        {\n            // User scroll event : set or unset auto-scroll mode\n            if (e.ExtentHeightChange == 0)\n            {   // Content unchanged : user scroll event\n                if (ScrollViewer.VerticalOffset == ScrollViewer.ScrollableHeight)\n                {   // Scroll bar is in bottom\n                    // Set auto-scroll mode\n                    _autoscroll = true;\n                }\n                else\n                {   // Scroll bar isn\'t in bottom\n                    // Unset auto-scroll mode\n                    _autoscroll = false;\n                }\n            }\n\n            // Content scroll event : auto-scroll eventually\n            if (_autoscroll && e.ExtentHeightChange != 0)\n            {   // Content changed and auto-scroll mode set\n                // Autoscroll\n                ScrollViewer.ScrollToVerticalOffset(ScrollViewer.ExtentHeight);\n            }\n        }\n\n        private void ScrollViewer_PreviewMouseWheel(object sender, System.Windows.Input.MouseWheelEventArgs e)\n        {\n            ScrollViewer scv = (ScrollViewer)sender;\n            scv.ScrollToVerticalOffset(scv.VerticalOffset - e.Delta / 10);\n            e.Handled = true;\n        }\n\n        /// <summary>\n        /// Finds a Child of a given item in the visual tree. \n        /// </summary>\n        /// <param name="parent">A direct parent of the queried item.</param>\n        /// <typeparam name="T">The type of the queried item.</typeparam>\n        /// <param name="childName">x:Name or Name of child. </param>\n        /// <returns>The first parent item that matches the submitted type parameter. \n        /// If not matching item can be found, \n        /// a null parent is being returned.</returns>\n        public static T FindChild<T>(DependencyObject parent, string childName = "")\n           where T : DependencyObject\n        {\n            // Confirm parent and childName are valid. \n            if (parent == null) return null;\n\n            T foundChild = null;\n\n            int childrenCount = VisualTreeHelper.GetChildrenCount(parent);\n            for (int i = 0; i < childrenCount; i++)\n            {\n                var child = VisualTreeHelper.GetChild(parent, i);\n                // If the child is not of the request child type child\n                T childType = child as T;\n                if (childType == null)\n                {\n                    // recursively drill down the tree\n                    foundChild = FindChild<T>(child, childName);\n\n                    // If the child is found, break so we do not overwrite the found child. \n                    if (foundChild != null) break;\n                }\n                else if (!string.IsNullOrEmpty(childName))\n                {\n                    var frameworkElement = child as FrameworkElement;\n                    // If the child\'s name is set for search\n                    if (frameworkElement != null && frameworkElement.Name == childName)\n                    {\n                        // if the child\'s name is of the request name\n                        foundChild = (T)child;\n                        break;\n                    }\n                }\n                else\n                {\n                    // child element found.\n                    foundChild = (T)child;\n                    break;\n                }\n            }\n\n            return foundChild;\n        }\n\n        #endregion\n    }\n}\n')),(0,r.kt)("h3",{id:"create-an-api-service"},"Create an API service"),(0,r.kt)("p",null,"UI-side API service is a class that inherits from gRPC class that is auto-generated on a project build by the gRPC tools. Its responsibility is to listen to clients and update the mutable model"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"First, create a new .NET Core class library project and name it ",(0,r.kt)("inlineCode",{parentName:"li"},"ProjectWeekendPuzzles.<YourModule>.Api")),(0,r.kt)("li",{parentName:"ul"},"Do not forget to set the target framework to ",(0,r.kt)("inlineCode",{parentName:"li"},"net5.0-windows")),(0,r.kt)("li",{parentName:"ul"},"Reference the model project"),(0,r.kt)("li",{parentName:"ul"},"Create ",(0,r.kt)("inlineCode",{parentName:"li"},"Protos")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"Services")," folders")),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"As I mentioned earlier, there is a problem with the generation of gRPC assets from .proto files in the WPF project; you can learn more about this known issue ",(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/aspnet/core/grpc/troubleshoot?view=aspnetcore-3.0#wpf-projects-unable-to-generate-grpc-c-assets-from-proto-files"},"here"),". The simplest workaround for it is to keep gRPC tools in a separate project. That is also a reason for having the separate model project just to break the circular dependency"))),(0,r.kt)("p",null,"Proto files let for type-safe remoting that can be versioned, which is a huge advantage."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Create a .proto file that will define IPC remote calls and messages. This very .proto file will be copied to and used as the contract and the scaffold source by a client project")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-protobuf",metastring:'title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Api\\Protos\\step-list.proto"',title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Api\\Protos\\step-list.proto"'},'syntax = "proto3";\n\noption csharp_namespace = "ProjectWeekendPuzzles.StepList.Api";\n\npackage stepList;\n\nservice StepListUpdater {\n  rpc AddStep (AddRequest) returns (AddReply);\n  rpc ClearList (ClearRequest) returns (ClearReply);\n}\n\nmessage AddRequest {\n  string name = 1;\n  string result = 2;\n  enum StepStatus {\n        PASS = 0;\n        FAIL = 1;\n        ERROR = 2;\n  }\n  StepStatus status = 3;\n}\n\nmessage AddReply {\n  bool success = 1;\n}\n\nmessage ClearRequest {\n\n}\n\nmessage ClearReply {\n    bool success = 1;\n}\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"To the 'Services\" folder, add a new class"),(0,r.kt)("li",{parentName:"ul"},"Name it ",(0,r.kt)("inlineCode",{parentName:"li"},"<YourModule>XXXService")),(0,r.kt)("li",{parentName:"ul"},"Make it inherit from auto-generated gRPC service base class"),(0,r.kt)("li",{parentName:"ul"},"In ctor, ask for the ",(0,r.kt)("inlineCode",{parentName:"li"},"<YourModule>Model")),(0,r.kt)("li",{parentName:"ul"},"Provide implementation by overriding ",(0,r.kt)("inlineCode",{parentName:"li"},"virtual"),"s")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Api\\Services\\StepListUpdaterService.cs"',title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Api\\Services\\StepListUpdaterService.cs"'},'using Grpc.Core;\nusing ProjectWeekendPuzzles.StepList.Model;\nusing System;\nusing System.Threading.Tasks;\n\nnamespace ProjectWeekendPuzzles.StepList.Api.Services\n{\n    public class StepListUpdaterService : StepListUpdater.StepListUpdaterBase\n    {\n        private readonly StepListModel _stepListModel;\n\n        public StepListUpdaterService(StepListModel stepListModel)\n        {\n            _stepListModel = stepListModel;\n        }\n\n        public override Task<AddReply> AddStep(AddRequest request, ServerCallContext context)\n        {\n            var newStep = new Step(request.Name, request.Result, ConvertStatus(request.Status));\n            _stepListModel.AddSteps(new[] { newStep });\n            return Task.FromResult(new AddReply { Success = true });\n        }\n\n        public override Task<ClearReply> ClearList(ClearRequest request, ServerCallContext context)\n        {\n            _stepListModel.Clear();\n            return Task.FromResult(new ClearReply { Success = true });\n        }\n\n        private static Step.StepStatus ConvertStatus(AddRequest.Types.StepStatus stepStatus)\n            => stepStatus switch\n            {\n                AddRequest.Types.StepStatus.Pass => Step.StepStatus.Pass,\n                AddRequest.Types.StepStatus.Fail => Step.StepStatus.Fail,\n                AddRequest.Types.StepStatus.Error => Step.StepStatus.Error,\n                _ => throw new ArgumentOutOfRangeException(nameof(stepStatus), $"Cannot convert {nameof(AddRequest.Types.StepStatus)} because of the incompatible value.")\n            };\n    }\n}\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"In ",(0,r.kt)("inlineCode",{parentName:"li"},"<YourModule>Module")," class, register ",(0,r.kt)("inlineCode",{parentName:"li"},"<YourModule>XXXService")," through ",(0,r.kt)("inlineCode",{parentName:"li"},"ApiServiceCollection")," (do not forget to reference ",(0,r.kt)("inlineCode",{parentName:"li"},"ProjectWeekendPuzzles.<YourModule>.Api")," before)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'{4-5,15,19} title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\StepListModule.cs"',"{4-5,15,19}":!0,title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList\\StepListModule.cs"'},'using Prism.Ioc;\nusing Prism.Modularity;\nusing Prism.Regions;\nusing ProjectWeekendPuzzles.Core.ApiServer;\nusing ProjectWeekendPuzzles.StepList.Api.Services;\nusing ProjectWeekendPuzzles.StepList.Model;\nusing ProjectWeekendPuzzles.StepList.Views;\n\nnamespace ProjectWeekendPuzzles.StepList\n{\n    public class StepListModule : IModule\n    {\n        private readonly IRegionManager _regionManager;\n\n        public StepListModule(IRegionManager regionManager, ApiServiceCollection apiServiceCollection)\n        {\n            _regionManager = regionManager;\n\n            apiServiceCollection.AddApiService<StepListUpdaterService>();\n        }\n\n        public void OnInitialized(IContainerProvider containerProvider)\n        {\n            _regionManager.RegisterViewWithRegion<StepListView>("main-content-region");\n        }\n\n        public void RegisterTypes(IContainerRegistry containerRegistry)\n        {\n            containerRegistry.RegisterSingleton<StepListModel>();\n        }\n    }\n}\n')),(0,r.kt)("h3",{id:"create-an-api-client"},"Create an API client"),(0,r.kt)("p",null,"The last thing needed for our module to fully work is a client. As the UI and its clients are ",(0,r.kt)("em",{parentName:"p"},"almost")," zero-coupled (",(0,r.kt)("em",{parentName:"p"},"almost")," because we still have a shared ",(0,r.kt)("inlineCode",{parentName:"p"},".proto")," file), we can use a different technology to build the client."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Create a new .NET Framework library project that targets version 4.6.1"),(0,r.kt)("li",{parentName:"ul"},"Add following package references",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Grpc.Tools"),(0,r.kt)("li",{parentName:"ul"},"Google.Protobuf"),(0,r.kt)("li",{parentName:"ul"},"Grpc.Core.Api"),(0,r.kt)("li",{parentName:"ul"},"Grpc.Net.Client"),(0,r.kt)("li",{parentName:"ul"},"Grpc.Net.Client.Web"),(0,r.kt)("li",{parentName:"ul"},"System.Net.Http.WinHttpHandler"))),(0,r.kt)("li",{parentName:"ul"},"Create ",(0,r.kt)("inlineCode",{parentName:"li"},"Protos")," folder from the API project"),(0,r.kt)("li",{parentName:"ul"},"Next, unload the project and add the following snippet to it if not already present")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Client\\ProjectWeekendPuzzles.StepList.Client.csproj"',title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Client\\ProjectWeekendPuzzles.StepList.Client.csproj"'},'...\n\n<ItemGroup>\n    <Protobuf Include="Protos\\dashboard.proto" GrpcServices="Client" />\n  </ItemGroup>\n\n...\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Reload and build the project to generate gRPC assets"),(0,r.kt)("li",{parentName:"ul"},"Add App.config and put the port number in it"),(0,r.kt)("li",{parentName:"ul"},"Create the ",(0,r.kt)("inlineCode",{parentName:"li"},"<YourModule>XXXClient")," class")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'title="\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Client\\StepListUpdaterClient.cs"',title:'"\\src\\modules\\step-list\\ProjectWeekendPuzzles.StepList.Client\\StepListUpdaterClient.cs"'},'using Grpc.Net.Client;\nusing Grpc.Net.Client.Web;\nusing ProjectWeekendPuzzles.StepList.Api;\nusing System;\nusing System.Net.Http;\nusing System.Configuration;\nusing System.Threading.Tasks;\n\nnamespace ProjectWeekendPuzzles.StepList.Client\n{\n    public class StepListUpdaterClient : IDisposable\n    {\n        private readonly GrpcChannel _channel;\n        private readonly StepListUpdater.StepListUpdaterClient _client;\n\n        public StepListUpdaterClient()\n        {\n            var portStr = ConfigurationSettings.AppSettings["port"] ?? "55331"; // fallback to default\n            var port = int.Parse(portStr);\n\n            _channel = GrpcChannel.ForAddress($"https://localhost:{port}", new GrpcChannelOptions\n            {\n                HttpHandler = new GrpcWebHandler(new WinHttpHandler())\n            });\n\n            _client = new StepListUpdater.StepListUpdaterClient(_channel);\n        }\n\n        public async Task<AddReply> AddStepAsync(string name, string result, StepStatus status)\n            => await _client\n                .AddStepAsync(new AddRequest { Name = name, Result = result, Status = (AddRequest.Types.StepStatus) status })\n                .ResponseAsync;\n\n        public async Task<ClearReply> ClearAsync()\n            => await _client\n                .ClearListAsync(new ClearRequest())\n                .ResponseAsync;\n\n        public void Dispose() => _channel.Dispose();\n\n        public enum StepStatus\n        {\n            Pass,\n            Fail,\n            Error\n        }\n    }\n}\n')),(0,r.kt)("h3",{id:"run-the-project-1"},"Run the project"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Finally, rebuild the entire project and test your module through its client")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Step list",src:n(542).Z})))}p.isMDXComponent=!0},1909:function(e,t,n){t.Z=n.p+"assets/images/add-folders-07e67aa2c27a0c193af8402ef6df45e1.png"},9131:function(e,t,n){t.Z=n.p+"assets/images/add-materialdesign-references-bf15055757f13e441765f23a3db1594e.png"},1827:function(e,t,n){t.Z=n.p+"assets/images/add-new-class-b638ea663879146953ef356d781664e1.png"},6182:function(e,t,n){t.Z=n.p+"assets/images/add-prism-wpf-reference-74b0ae5b5af85ae5c45363b557d0803c.png"},6348:function(e,t,n){t.Z=n.p+"assets/images/add-project-references-912181dd0337d884594948de098bd248.png"},2039:function(e,t,n){t.Z=n.p+"assets/images/add-user-control-to-project-e0d4750fc71f7227732efe8db17bf372.png"},2632:function(e,t,n){t.Z=n.p+"assets/images/debug-options-fc4cfa30072c43f352c9d6fa9e1ec843.png"},8783:function(e,t,n){t.Z=n.p+"assets/images/module-loaded-9d8538ed6f5e00d0316582876b823bae.png"},3312:function(e,t,n){t.Z=n.p+"assets/images/new-project-names-bff4481281c7dc62ea6caf78100f6d06.png"},7376:function(e,t,n){t.Z=n.p+"assets/images/new-project-target-57744574db6d2226ec7f15ea0b20c937.png"},9487:function(e,t,n){t.Z=n.p+"assets/images/new-project-type-c61ccd9b0642ec82b9f115bbb57a9a46.png"},2279:function(e,t,n){t.Z=n.p+"assets/images/post-build-event-command-3ed7a6975f9345c6374a52fc58c76173.png"},3151:function(e,t,n){t.Z=n.p+"assets/images/project-properties-fed40ffcbbc1005e9115e9d84245d718.png"},5561:function(e,t,n){t.Z=n.p+"assets/images/project-reference-added-7fcbb7d0edca7f74280508fafdffcb3d.png"},542:function(e,t,n){t.Z=n.p+"assets/images/step_list-275caa5fe019a17e5f5938feb109af34.gif"}}]);